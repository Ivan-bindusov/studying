Атрибут `macro_use` имеет две цели. Во-первых, его можно использовать, чтобы область действия макроса модуля не заканчивалась при закрытии модуля, применив его к модулю:
![[2024-04-01 17 26 21.jpg]]
Во-вторых, его можно использовать для импорта макросов из другого крейта, прикрепив его к объявлению `extern crate` , появляющемуся в корневом модуле крейта. Макросы, импортированные таким образом, импортируются в [`macro_use` prelude](https://runebook.dev/ru/docs/rust/reference/names/preludes#macro_use-prelude) , а не в текстовом виде, что означает, что их можно затенить любым другим именем. Хотя макросы, импортированные `#[macro_use]` , можно использовать перед оператором импорта, в случае конфликта побеждает последний импортированный макрос. При желании список макросов для импорта можно указать с помощью синтаксиса [MetaListIdents](https://runebook.dev/ru/docs/rust/reference/attributes#meta-item-attribute-syntax) ; это не поддерживается, когда `#[macro_use]` применяется к модулю.
![[2024-04-01 17 26 33.jpg]]
Макросы, импортируемые с помощью `#[macro_use]` , необходимо экспортировать с помощью `#[macro_export]` , как описано ниже.
## Path-Based Scope
По умолчанию макрос не имеет области действия на основе пути. Однако если он имеет атрибут `#[macro_export]` , то он объявлен в корневой области крейта и обычно может называться так:
![[2024-04-01 17 28 00.jpg]]
Макросы, помеченные `#[macro_export]` , всегда являются `pub` , и на них могут ссылаться другие ящики либо по пути, либо по `#[macro_use]` , как описано выше.